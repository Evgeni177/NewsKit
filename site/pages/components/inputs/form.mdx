import Layout from '../../../components/layout';
import Playground from '../../../components/playground';
import {Prop} from '../../../components/prop';
import {TextBoxSwatch} from '../../../components/theming-values/colors';
import {LegacyBlock} from '../../../components/legacy-block';
import {CodeFromFile} from '../../../components/code';

import {Form, TextInput, Block, Button, styled} from 'newskit';

export default Layout;

# Form

## Overview

The Form component is used for processing form data; it's based on [React Hook Form](https://react-hook-form.com/)

## Usage

The Form component is used by wrapping around form fields, such as the TextInput. On submission, it passes the form data to the provided callback function. 
The inputs don't need to be direct children of the Form component and can be nested inside other elements.
A submit button is required to be passed to the Form component, and the name property is required on the input. 

<CodeFromFile path="examples/form/form.tsx" />

## Validation

The Form component handles validation. This only works with the TextInput. The validation rules need to be passed to the TextInput. For more information about the validation rules:
[React Hook Form, apply validation](https://react-hook-form.com/get-started/#Applyvalidation) and [React Hook Form, register](https://react-hook-form.com/api/#register)

<CodeFromFile path="examples/form/validated-form.tsx" />

## Props

<LegacyBlock marginTop="sizing040">
  <Prop name="children" type="Exclude<React.ReactNode, 'undefined'>" required>
    The form requires to have at least a TextInput and a submit button.  
  </Prop>
  <Prop name="onSubmit" type="(data: Record<string, string>) => void" required>
    Function which processes the submited data. 
    The data parameter consists of an object where the input field names are associated with the input values.
  </Prop>
  <Prop name="validationMode" type="onSubmit | onValidation" default="onSubmit">
    This option allows you to configure when input fields getting validated. Currently 'onSubmit' and 'onBlur' supported.  
  </Prop>
   <Prop name="reValidationMode" type="onSubmit | onValidation" default="onBlur">
    This option allows you to configure when input fields getting revalidated. Currently 'onSubmit' and 'onBlur' supported.  
  </Prop>
</LegacyBlock>

<Playground
  componentName="Form"
  component={state => {
    const onSubmit = data => console.log('Submitted data:', data);
    
    const Container = styled.div`
      width: 300px;
    `
    
    return (
      <React.Fragment>
        <LegacyBlock display="flex">
          <Container>
              <Form onSubmit={onSubmit} validationMode={state.validationMode} reValidationMode={state.reValidationMode}>
                <Block overrides={{spaceStack: 'space060'}}>
                  <TextInput
                    label="Email"
                    name="email"
                    assistiveText="Your email"
                    rules={{
                      required: 'Required field',
                      pattern: {
                        value: /^(([^<>()\[\]\.,;:\s@\"]+(\.[^<>()\[\]\.,;:\s@\"]+)*)|(\".+\"))@(([^<>()[\]\.,;:\s@\"]+\.)+[^<>()[\]\.,;:\s@\"]{2,})$/i,
                        message: 'Please provide a valid email',
                      },
                    }}
                  />
                </Block>
                <Block overrides={{spaceStack: 'space060'}}>
                  <TextInput
                    label="Username"
                    name="username"
                    assistiveText="Your username"
                    rules={{
                      required: 'Required field',
                      minLength: { value: 5, message: 'Usernames must be at least 5 characters long' },
                    }}
                  />
                </Block>
                <Button type="submit">Submit</Button>
              </Form>
          </Container>
        </LegacyBlock>
      </React.Fragment>
    );
    }
  }
  knobs={[
    {
      name: 'Validation Mode',
      propName: 'validationMode',
      options: [
        {
          label: 'Default (onSubmit)',
          value: undefined,
        },
        {
          label: 'onBlur',
          value: 'onBlur',
        },
      ],
    },
    {
      name: 'ReValidation Mode',
      propName: 'reValidationMode',
      options: [
        {
          label: 'Default (onBlur)',
          value: undefined,
        },
        {
          label: 'onSubmit',
          value: 'onSubmit',
        },
      ],
    }
  ]}
/>