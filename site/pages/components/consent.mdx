import Layout from '../../components/layout';
import Playground from '../../components/playground';
import Prop from '../../components/prop';
import {Code, CodeFromFile} from '../../components/code';
import {LegacyBlock} from '../../components/legacy-block';

export default Layout;

# Consent

## Overview

The consent component is a non-visual component for the consent of the use of 3rd party cookies. It triggers the loading of a Sourcepoint CMP (Content Management Platform) dialog to allow the user to decide what 3rd party cookies they wish to allow or disallow on their browser. Unless you are utilising React Helmet, it must be placed inside the head of the document during server-side rendering. NewsKit has both an AMP and non-AMP version of this component. The two are not interchangeable so you must ensure you use the correct one.

## Prerequisites

To utilise this component you will need to have a [Sourcepoint](https://www.sourcepoint.com) account and, if required, a Sourcepoint messaging subdomain set up. For more information please see Sourcepoint [documentation](https://documentation.sourcepoint.com/web-implementation/sourcepoint-set-up-and-configuration-v2).

## Usage

<CodeFromFile path="examples/consent.tsx" />

## Props

<LegacyBlock $marginTop="sizing040">
  <Prop name='sourcePointConfig' type="SourcePointConfigProps"  required>
    The config config that initialises sourcePoint.
    Required parameters: <b>accountId</b>.
    optional Parameters: <b>siteHref, privacyManagerId, siteId, targetingParams, mmsDomain, waitForConsent</b>. See <a href="https://documentation.sourcepoint.com/web-implementation/sourcepoint-set-up-and-configuration-v2">Sourcepoint documentation</a> for full description of options.
  </Prop>
  <Prop name="accountId" type="string">
    <b>This Prop is deprecated on the component and should be set in the sourcepoint config.</b> Your Sourcepoint account id.
  </Prop>
  <Prop
    name="mmsDomain"
    type="string"
    default="https://message{accountId}.sp-prod.net"
  >
    <b>This Prop is deprecated on the component and should be set in the sourcepoint config. </b>
    Can be changed to a CNAMED subdomain in order to deliver 1st party cookies
    on Safari web browser (due to Safariâ€™s ITP). Changing the mmsDomain is
    optional! More information about setting up an mmsDomain below.
  </Prop>
  <Prop name="waitForConsent" type="boolean" default="true">
    When true (the default value), the consent component will cause prebid.js to
    wait for user consent to be provided before it initialises.
  </Prop>
  <Prop name="reactHelmet" type="react-helmet Helmet Component">
    By default the Consent component will inject its scripts by rendering script
    tags. However, if your project is using &nbsp;
    <a href="https://www.npmjs.com/package/react-helmet" target="_blank">React Helmet</a>
    &nbsp; you can pass the Helmet
    component in and the scripts will render using that component.
  </Prop>
</LegacyBlock>

## How to run on localhost

In order to run the consent component locally, you will need to edit the Hosts file.
The steps to accomplish that depends on your OS.
You can find more detailed information on how to do that
[here](https://www.howtogeek.com/howto/27350/beginner-geek-how-to-edit-your-hosts-file/).

After you open the hosts file, look for a line like that looks like this:

`127.0.0.1 localhost`

 It is not mandatory to have it, but if you do comment the line using `#` sign:

`#127.0.0.1 localhost`

Add a new line with your local address (127.0.0.1) and the domain name instead of `localhost`:

`127.0.0.1 example-domain.com`

In the case of the newskit site it would look like this:

`127.0.0.1 newskit.co.uk`

This will result in a redirect to your `localhost` when attempting to hit the said domain.

Now would be a good time to start your localhost server if it is not running.

*Note: if you are running your localhost on a port, then you have to add the port after the domain when you open it on the browser:*

`example-domain.com:8080`

**Note: Don't forget to revert your changes in the Hosts file after you are finished with running consent locally**

The minimum parameters of the Consent component to run locally are a sourcePointConfig object with accountId.

<Code>
  {`<Consent
    sourcePointConfig={{
      accountId: accountId,
    }}
  />`}
</Code>



# AMP

## Usage With AMP

Note the use of the AMP `Head` component. The `Consent` component must be used as a child of `Head`. See [Getting Started with AMP](/guides/getting-started-amp) for more information.

<CodeFromFile path="examples/amp/consent.tsx" />

## Props With AMP

<LegacyBlock $marginTop="sizing040">
  <Prop name='sourcePointConfig' type="SourcePointConfigProps" required>
    The config config that initialises sourcePoint.
    Required parameters: <b>accountId, siteName</b>.
    optional Parameters: <b>privacyManagerId, siteId and targetingParams</b>.
  </Prop>
   <Prop name="accountId" type="string">
    <b>This Prop is deprecated on the component and should be set in the sourcepoint config. </b>Your Sourcepoint account id.
  </Prop>
  <Prop name="siteName" type="string">
    <b>This Prop is deprecated on the component and should be set in the sourcepoint config. </b>The name of your site.
  </Prop>
  <Prop name="privacyManagerId" type="string">
    <b>This Prop is deprecated on the component and should be set in the sourcepoint config. </b> This attribute corresponds to the ID of the privacy manager used for this
    site.
  </Prop>
  <Prop name="postPromptUI" type="string" default="privacy-settings-prompt">
    This is the reference to on-page element that will display after a user has
    provided consent. When this element appears a user can click on it to change
    their consent preferences.
  </Prop>
</LegacyBlock>
