import Layout from '../../components/layout';
import Playground from '../../components/playground';
import Prop from '../../components/prop';
import {Code, CodeFromFile} from '../../components/code';
import {LegacyBlock} from '../../components/legacy-block';

export default Layout;

# Consent

## Overview

The consent component is a non-visual component for the consent of the use of 3rd party cookies. It triggers the loading of a Sourcepoint CMP (Content Management Platform) dialog to allow the user to decide what 3rd party cookies they wish to allow or disallow on their browser.
Unless you are utilising React Helmet, it must be placed inside the body of the document during server-side rendering. NewsKit has both an AMP and non-AMP version of this component. The two are not interchangeable so you must ensure you use the correct one.

At the moment this component is supporting two version of the Sourcepoint config. Versions TCFV1 and TCFV2.

## Prerequisites

To utilise this component you will need to have a [Sourcepoint](https://www.sourcepoint.com) account and, if required, a Sourcepoint messaging subdomain set up. For more information
please see Sourcepoint [documentation TCFV2](https://documentation.sourcepoint.com/web-implementation/sourcepoint-gdpr-and-tcf-v2-support-beta/gdpr-and-tcf-v2-setup-and-configuration) and
[documentation TCFV1](https://documentation.sourcepoint.com/web-implementation/sourcepoint-set-up-and-configuration-v2) for the version 1.

## Usage

<CodeFromFile path="examples/consent.tsx" />

## Props V2

<LegacyBlock marginTop="sizing040">
  <Prop name="sourcePointConfig" type="SourcePointConfigProps" required>
    The config that initialises sourcePoint. Required parameters:{' '}
    <b>accountId</b>. optional Parameters:{' '}
    <b>
      propertyHref, privacyManagerId, siteId, targetingParams, mmsDomain,
      waitForConsent
    </b>
    . See <a href="https://documentation.sourcepoint.com/web-implementation/sourcepoint-set-up-and-configuration-v2">
      Sourcepoint documentation
    </a> for full description of options.
  </Prop>
  <Prop name="reactHelmet" type="react-helmet Helmet Component">
    By default the Consent component will inject its scripts by rendering script
    tags. However, if your project is using &nbsp;
    <a href="https://www.npmjs.com/package/react-helmet" target="_blank">
      React Helmet
    </a>
    &nbsp; you can pass the Helmet component in and the scripts will render
    using that component.
  </Prop>
</LegacyBlock>

## Props V1

If you want to use the TCF1 version of the consent the only thing to change is
replace propertyHref, if you are using it, with siteHref in the sourcePointConfig object.

<Code>
  {`
    accountId: accountId,
    siteHref: 'http://newskit.co.uk/'
  `}
</Code>

## How to run on localhost

The minimum parameters for the Consent component to run locally are a sourcePointConfig object with accountId and siteHref for TCFV1 and with an accountId and propertyHref for TCFV1.
The `siteHref` or `propertyHref` property should be an url that that exists in your account's property group. Contact your sourcepoint account manager.

In a V2 example it would look like this:

<Code>
  {`<Consent
    sourcePointConfig={{
      accountId: accountId,
      propertyHref: 'http://newskit.co.uk/'
    }}
  />`}
</Code>

# AMP

## Usage With AMP

Note the use of the AMP `Head` component. The `Consent` component must be used as a child of `Head`. See [Getting Started with AMP](/guides/getting-started-amp) for more information.

<CodeFromFile path="examples/amp/consent.tsx" />

## Props With AMP

<LegacyBlock marginTop="sizing040">
  <Prop name="sourcePointConfig" type="SourcePointConfigProps" required>
    The config that initialises sourcePoint. Required parameters:{' '}
    <b>accountId, siteName</b>. Optional Parameters:{' '}
    <b>privacyManagerId, siteId, stageCampaign and targetingParams</b>.
  </Prop>
  <Prop name="postPromptUI" type="string" default="privacy-settings-prompt">
    This is the reference to on-page element that will display after a user has
    provided consent. When this element appears a user can click on it to change
    their consent preferences.
  </Prop>
</LegacyBlock>
